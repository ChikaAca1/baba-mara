# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

**Baba Mara** is an AI-powered spiritual advisor platform offering digital fortune telling (coffee cup and tarot readings) through voice-based interactions. The platform targets Turkish and English-speaking markets with multilingual support (TR, EN, SR).

**Tech Stack:**
- Frontend: Next.js 14 (App Router)
- Deployment: Vercel (auto-deploy from GitHub main)
- Database/Auth: Supabase
- Payments: Payten API (REST integration)
- Voice AI: ElevenLabs or cost-effective alternative
- Real-time Audio: LiveKit (voice-only calls)
- Repository: GitHub (main branch)

**Domain Structure:**
- ðŸ‡¹ðŸ‡· Turkish: fal.baba-mara.com â†’ babamara.com/tr
- ðŸ‡ºðŸ‡¸ English: mysticcup.baba-mara.com â†’ babamara.com/en
- ðŸ‡·ðŸ‡¸ Serbian: baba-mara.com/sr â†’ baba-mara.com

## Architecture

### Directory Structure
```
/baba-mara
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ tr/              # Turkish locale routes
â”‚   â”œâ”€â”€ en/              # English locale routes
â”‚   â”œâ”€â”€ sr/              # Serbian locale routes
â”‚   â”œâ”€â”€ components/      # Shared React components
â”‚   â””â”€â”€ api/             # API routes
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ livekit/         # LiveKit integration
â”‚   â”œâ”€â”€ payten/          # Payten payment API
â”‚   â”œâ”€â”€ supabase/        # Supabase client and helpers
â”‚   â””â”€â”€ elevenlabs/      # Voice synthesis integration
â”œâ”€â”€ context.md           # Auto-updated project context
â”œâ”€â”€ README.md
â””â”€â”€ .env.local
```

### Core Modules

**Authentication (Supabase)**
- Email + password registration/login
- Google OAuth integration
- Optional anonymous "guest" mode for first reading

**User Dashboard**
- Reading history view
- Remaining readings counter
- "Ask New Question" action

**AI Reading Engine**
- Input: User's text question
- Processing: Claude (or similar) generates mystical narrative
- Output: Audio response via ElevenLabs API
- LiveKit integration for real-time voice chat (audio-only)

**Payment System (Payten REST API)**
- Single reading: $1.99
- Monthly subscription: $9.99 (12 readings)
- Top-up: $9.99 (10 additional readings)

**Admin Panel**
- User/transaction overview
- Error monitoring
- Manual credit reset capability

### Multi-language Implementation
Uses Next.js i18n with three locales (en, tr, sr). All UI text and AI responses must be localized.

### Legal Disclaimer
Every language version must display:
> "These readings are generated by an AI-based digital advisor and are intended solely for entertainment and introspective purposes. They are not professional advice."

## Development Workflow

### Iterative Development Process
Claude Code operates in 3-5 iteration cycles:
1. Create initial code and project structure
2. Implement key integrations (Supabase, LiveKit, Payten)
3. Test and fix issues
4. Compress context into context.md
5. Request confirmation before git push to main
6. Auto-deploy to Vercel

### Context Management
After every 3-5 iterations, automatically update `context.md` with:
- Date
- What was completed
- Code/architecture changes
- TODO sections

### Git Workflow
- Always ask Aleksandar for confirmation before pushing to main
- Main branch triggers automatic Vercel deployment
- Verify build success after deployment

### Integration Points

**Supabase Setup:**
- Configure auth providers (email, Google)
- Create tables: users, readings, transactions, subscriptions
- Set up row-level security policies
- Store reading history and user credits

**LiveKit Integration:**
- Real-time voice communication (audio-only)
- Placeholder UI for future Heygen avatar integration
- Handle connection lifecycle and error states

**Payten API:**
- Use REST-based integration (document-based)
- Handle payment webhooks for subscription management
- Implement secure payment flow with error handling

**Voice Synthesis:**
- ElevenLabs API or cost-effective alternative
- Mystical tone and character consistency
- Support for multiple languages (EN, TR, SR)

### Key Considerations

**User Confirmation Required For:**
- Architecture changes
- Payment system modifications
- Deployment operations

**Documentation:**
- Use Claude 4.5 Sonnet for development
- Maintain context.md automatically
- Document all API integrations and configuration

**Security:**
- Never commit API keys or secrets
- Use environment variables (.env.local)
- Implement proper RBAC in Supabase

### Development Commands

When the project is initialized, this section will contain:
- Build commands
- Development server
- Testing procedures
- Linting and formatting
- Database migrations

(To be populated once project structure is created)
